//Known IOCs and post-exploitation artifacts in fortinet_fortimanager_raw logs
config case_sensitive = false
| dataset = fortinet_fortimanager_raw
| filter _raw_log in
("*tmp/","*45.32.41.202*","*104.238.141.143*","*158.247.199.37*","*195.85.114.78*","*VMTM23
017412*","*Unregistered device localhost add
succeeded*","*0qsc137p@justdefinition.com*","*Purity Supreme*")
| alter elog_changes = regextract(_raw_log, "changes=\"(.*)\"")
| alter elog_msg = regextract(_raw_log, "msg=\"(.*)\"")


//Proactively review operations for ‘Add device’ and ‘Modify device’ that cannot be
attributed to known activity

config case_sensitive = false
| dataset = fortinet_fortimanager_raw
| filter _raw_log in ("*Add device*","*Modify device*")
| alter elog_changes = regextract(_raw_log, "changes=\"(.*)\"")
| alter elog_msg = regextract(_raw_log, "msg=\"(.*)\"")
